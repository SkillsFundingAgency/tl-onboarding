<!-- Main content -->
<main id="main-content" role="main">
    <!-- Search Hero -->
    <div class="tl-hero tl-hero--minimal">
        <div class="govuk-width-container">
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-one-half">

                    <div id="tl-breadcrumbs--article">
                        <div class="tl-breadcrumbs">
                            {{breadcrumbs}}
                        </div>
                    </div>
                </div>
                <div class="govuk-grid-column-one-half tl-text--right govuk-!-margin-top-1">
                    <div class="tl-form-group tl-search--container tl-search--home tl-search--home--minimal" id="tl-search--newsletters">

                        <div class="tl-search--error tl-hidden">
                            <span class="tl-error--message"></span>
                        </div>
                        <form role="search" class="tl-search" data-search="" action="/hc/en-gb/search" accept-charset="UTF-8" method="get">
                            <input name="utf8" type="hidden" value="âœ“"><input type="search" name="query" id="query" placeholder="Search for support" aria-label="Search for support">
                            <input type="hidden" name="filter_by" value="knowledge_base" />
                            <input type="submit" name="commit" value="Search">
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Article Content -->
    <div class="govuk-width-container govuk-main-wrapper">

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <h1 class="govuk-heading-xl">{{section.name}}</h1>
                {{#if section.description}}
                <p class="govuk-body-l">{{section.description}}</p>
                {{/if}}
                <section>
                    <ul class="govuk-list">
                        {{#if section.articles}}

                        {{#each section.articles}}
                        <li>
                            <a class="govuk-link govuk-!-margin-bottom-1 tl-category--article" href="{{url}}">{{title}}</a>
                        </li>
                        {{/each}}
                        {{else}}
                        <li>
                            <p class="govuk-body">There's nothing here at the moment</p>
                        </li>

                        {{/if}}
                    </ul>

                </section>
            </div>
            <div class="govuk-grid-column-one-third">
                {{#if signed_in}}
                {{#if settings.show_follow_article}}
                <div class="article-subscribe tl-article--subscribe--signedin tl-js-visible" id="tl-newsletter--subscribe">
                    <button id="follow-btn" type="button" class="tl-hidden">Follow </button>
                    <script type="text/javascript">
                        const section_id_newsletters = {{settings.section_id_newsletters}}
                    </script>
                </div>
                {{/if}}
                {{else}}
                {{#if settings.show_follow_article}}
                <div class="article-subscribe tl-article--subscribe">
                    <button data-auth-action="signin" data-selected="false" aria-expanded="false" aria-haspopup="menu" type="button">
                        Sign in to get news updates
                    </button>

                    <p class="govuk-body-l">or...</p>
                    {{!-- Alternative approach using oauth in javascript --}}
                    <form id="subscribe-user-form" method="post">
                        <div class="govuk-form-group">
                            <label class="govuk-label" for="subscriber-name">Name</label>
                            <input type="text" id="subscriber-name" name="subscriber-name" placeholder="Type your name">
                        </div>
                        <div class="govuk-form-group">
                            <label class="govuk-label" for="subscriber-email">Name</label>
                            <input type="text" id="subscriber-email" name="subscriber-email" placeholder="Type your email">
                        </div>
                        <div class="govuk-!-margin-top-3">
                            <input type="submit" name="commit" value="Subscribe">
                        </div>
                    </form>
                    <script type="text/javascript">
                        $("#subscribe-user-form").submit(function(e){

                            e.preventDefault();
                            
                            const subscription_client_id = {{settings.tl_subscription_client_id}}
                            const subscription_client_secret = {{settings.tl_subscription_client_secret}}

                            subscriber-name = $("#subscriber-name").val();
                            subscriber_email = $("#subscriber-email").val();

                            console.log(`subscribe form submitted`);
                            console.log(`subscription_client_id = ${subscription_client_id}`);
                            console.log(`subscription_client_secret = ${subscription_client_secret}`);
                            console.log(`user = ${subscriber_email} (${subscriber_name})`);
                        });
                    </script>
                </div>
                {{/if}}
                {{/if}}
            </div>
        </div>
    </div>
</main>